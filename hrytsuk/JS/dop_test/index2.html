<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        *{
            padding: 0;
            margin: 0;
        }
        body{
            font-family: sans-serif;
            font-size: 18px;
        }
        .wrap{
            width: 300px;
            padding: 15px;
            margin: 0 auto;
        }
        select{
            display: block;
            width: 100%;
            box-sizing: border-box;
        }
        .mySelect{
            width: 100%;
        }
        .mySelect  .title{
            border: 1px solid black;
            padding: 10px;
        }
        .mySelect div.oprions{
            border: 1px solid;
            border-top: none;
            cursor: pointer;
            display: none;
        }
        .mySelect div.oprions li{
            list-style-type: none;
            padding: 10px 10px 10px 30px;
            cursor: pointer;
        }
        .mySelect div.oprions li:not(:last-child){
            border-bottom: 1px solid black;
        }
        .mySelect div.oprions li:hover{
            background-color: lightgray;
        }
        .active{
            display: block;
        }
        li[data-selected-option]{
            position: relative;
        }
        li[data-selected-option]::before{
           content: "";
            display: block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            position: absolute;
            background-color: #0b2e13;
            top: 50%;
            transform: translateY(-50%);
            left: 20px;
        }
    </style>
</head>
<body>
<div class="wrap">
<!--    <div class="mySelect" data-selected = '1'>-->
<!--        <div class="title">1</div>-->
<!--        <div class="oprions">-->
<!--            <ul>-->
<!--                <li data-option="1">1</li>-->
<!--                <li data-option="2">2</li>-->
<!--                <li data-option="3">3</li>-->
<!--            </ul>-->
<!--        </div>-->
<!--    </div>-->
    <select class="select" name="nn">
        <option value="1">1</option>
        <option value="2" >2</option>
        <option value="3" selected>3</option>
    </select>
</div>
<script>
    function CustomSelect(options) {
       this.options = options || {};                                    //коли приймаємо пусте створюєи пстий обєкт
        this.selector = this.createElem('div',{'class':'mySelect'});   //батьківський елемент
        this.optionsList = this.options.select.children;                // доступаємся до всіх опций
        this.optionBox = this.createElem('div',{'class':'options'});
       this.init = function () {
            var firstOption = this.getOptionContent(this.getSelected());    //визиваємо метод атрибутів вертає шндекс
            this.selector.appendChild(this.optionBox);
            this.selector.appendChild(this.createElem('div',setAttr(firstOption.attr,'title',true),firstOption.text));
                //викликаємо функцію передану build втрачається this call привязує і відразу визиває
           this.optionBox.appendChild(buildOption.call(this,this.createElem('ul')));
            this.selector.addEventListener('click', function (e) {
                this.optionBox.classList.add('active');
            }.bind(this));
           this.options.select.parentElement.insertBefore(this.selector,this.options.select);  //виводимо дані

       };
       function setAttr(attr,classElem,flag,text) {   //перевіряєм кількість атрибутів
           var data = {};
           for (var i=0;i< attr.length;i++){
               if (flag && !data['data-selected']){
                   data['data-selected']=attr.value.value;
               }
               else if(!flag & !data['data-option']){
                   data['data-option'] = attr.value.value;
               }
               if (attr.selected && !flag) data['data-selected-option'] = '';   //перевіряє чи є такий дата артибут
                if (classElem){
                    data['class'] = classElem;               //якщо є клас то ми його додаємо
                }
           }
           return data;
       }
       this.getSelected = function () {                         //функція перевірки чи є в опциях selected;
            for (var i=0; i<this.optionsList.length;i++){
               if(this.optionsList[i].selected) return i;          //перевірка наявності селекта
            }
            return 0;
       };
       this.getOptionContent = function (index) {
            var data = {};                                             //витягуємо значення з опций   повертає обєкт
           data.attr = this.optionsList[index].attributes;         //запис усіх атрибутів
           data.text = this.optionsList[index].textContent;       //запис тексту
           return data;
       };
        function buildOption (ul) {                  //функция яка створює html навколо селектора

            for(var i=0;i<this.optionsList.length;i++){
                var option = this.getOptionContent(i);
               ul.appendChild( createElem('li',setAttr(option.attr,undefined,false),option.text)) ;         // передаємо всі параметри наших li
            }
            return ul;       // ми передали все перемінній
       }
       this.init();
    }

    CustomSelect.prototype.createElem = createElem;
    var mySelect = new CustomSelect({
        select:document.querySelector('.select'),
    });
    function createElem(elem, attr,text) {
        if (!elem) return false;                                    //якщо елемент неприйшов передаємо фолс пририваємо функцію
        var el = document.createElement(elem);
        if (attr){
            for (var key in attr){
                el.setAttribute(key,attr[key]);                 //за допомогою цикла прохожусь по всім значенням
            }

        }
        if (text){
            el.textContent = text;
        }
        return el;                                           //створити ще одну функцію для заповнення контентом
    }
</script>
</body>
</html>
